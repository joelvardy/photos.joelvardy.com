function Swipe(){}function Analytics(){}function Lightbox(){}function Page(){}function Grid(){}Swipe.prototype={init:function(t,e){this.active=!1,this.startPosition={x:0,y:0},this.endPosition={x:0,y:0},this.leftCallback=t,this.rightCallback=e;var i=this;document.addEventListener("touchstart",function(t){if(1===t.targetTouches.length){var e=t.targetTouches[0];i.active=!0,i.startPosition.X=e.pageX,i.startPosition.Y=e.pageY}},!1),document.addEventListener("touchmove",function(t){if(1===t.targetTouches.length){var e=t.targetTouches[0];i.endPosition.X=e.pageX,i.endPosition.Y=e.pageY}},!1),document.addEventListener("touchend",function(t){i.active=!1;var e=i.startPosition.X-i.endPosition.X>0?"left":"right",o=Math.abs(i.startPosition.X-i.endPosition.X),n=Math.abs(i.startPosition.Y-i.endPosition.Y);if(o>50&&o/4>n)switch(e){case"left":i.leftCallback();break;case"right":i.rightCallback()}},!1)}},Analytics.prototype={init:function(){},event:function(t,e){ga("send","event","userActions",t,e)},externalLinks:function(){ga(function(){Array.prototype.forEach.call(document.querySelectorAll("p.information a"),function(t){t.addEventListener("click",function(t){t.preventDefault();var e=this,i;switch(t.target.classList.toString()){case"joelvardy":i="Joel Vardy";break;case"github":i="GitHub repo"}ga("send","event","userActions","External link",i,{hitCallback:function(){document.location.href=e.href}})})})})}},Lightbox.prototype={init:function(t){this.settings={overlayClass:"overlay",overlayPhotoClass:"overlay-photo",elements:window.photos.grid.gridElement().querySelectorAll("div.photo"),spacing:t},this.elements={body:document.querySelector("body")},this._setupElements(),this._registerClickListners(),this._registerSwipeListners()},_setupElements:function(){var t=this;if(this._isOpen=!1,this._pagePosition=0,!document.querySelector(this.settings.overlayClass)){var e=document.createElement("div");e.classList.add(this.settings.overlayClass),this.elements.overlay=document.body.appendChild(e)}if(this.elements.overlay.addEventListener("click",function(){t._hide(),window.photos.analytics.event("Lightbox: close","Clicked overlay")}),!document.querySelector(this.settings.overlayPhotoClass)){var i=document.createElement("div");i.classList.add(this.settings.overlayPhotoClass),this.elements.overlayPhoto=document.body.appendChild(i)}this.elements.overlayPhoto.addEventListener("click",function(){t.next(),window.photos.analytics.event("Lightbox: next photo","Clicked photo in lightbox")})},_show:function(){this._pagePosition=window.pageYOffset,this.elements.overlay.style.display="block",this.elements.overlayPhoto.style.display="block",this.elements.body.style.overflow="hidden",this._isOpen=!0},_hide:function(){var t=this;this.elements.body.style.overflow="auto",this.elements.overlayPhoto.style.display="none",this.elements.overlay.style.display="none",window.scroll(0,t._pagePosition),t._isOpen=!1,window.photos.page.clearHash(),window.photos.page.resetTitle()},repositionPhoto:function(){var t=this,e=(window.innerWidth-2*this.settings.spacing)/(window.innerHeight-2*this.settings.spacing),i=parseFloat(this.settings.elements[this.currentIndex].dataset.aspectRatio),o,n;e>i?(n=window.innerHeight-2*this.settings.spacing,o=Math.floor(n*i)):(o=window.innerWidth-2*this.settings.spacing,n=Math.floor(o/i)),this.elements.overlayPhoto.style.height=n+"px",this.elements.overlayPhoto.style.width=o+"px",this.elements.overlayPhoto.style.top=Math.floor((window.innerHeight-n)/2)+"px",this.elements.overlayPhoto.style.left=Math.floor((window.innerWidth-o)/2)+"px"},_updatePhoto:function(t){var e=this;e.repositionPhoto(),window.photos.page.getHash()!==t.dataset.hash&&window.photos.page.setHash(t.dataset.hash),window.photos.page.setTitle(t.getAttribute("title"));var i=document.createElement("img");if(i.src=t.dataset.small,i.complete||i.width+i.height>0){this.elements.overlayPhoto.style.backgroundImage=t.style.backgroundImage;var o=new Image;o.onload=function(){e.elements.overlayPhoto.style.backgroundImage="url("+t.dataset.large+")"},o.src=t.dataset.large}else this.elements.overlayPhoto.style.backgroundImage="url("+t.dataset.large+")"},_registerClickListners:function(){var t=this;Array.prototype.forEach.call(this.settings.elements,function(e,i){e.addEventListener("click",function(){t.currentIndex=i,t._updatePhoto(e),t._show(),window.photos.analytics.event("Lightbox: open","Clicked photo")})})},_registerSwipeListners:function(){var t=this;"ontouchstart"in document.documentElement&&window.photos.swipe.init(function(){t.isOpen()&&(t.next(),window.photos.analytics.event("Lightbox: next photo","Swipe"))},function(){t.isOpen()&&(t.previous(),window.photos.analytics.event("Lightbox: previous photo","Swipe"))})},isOpen:function(){return this._isOpen},open:function(t){var e=this,i=!1;Array.prototype.forEach.call(this.settings.elements,function(o,n){return o.dataset.hash===t?(i=!0,e.currentIndex=n,e._updatePhoto(o),void(e.isOpen()||e._show())):void(i||n!==e.settings.elements.length-1||window.photos.page.clearHash())})},close:function(){this._hide()},previous:function(){this.isOpen()&&("undefined"==typeof this.settings.elements[this.currentIndex-1]&&(this.currentIndex=this.settings.elements.length),this.currentIndex--,this._updatePhoto(this.settings.elements[this.currentIndex]))},next:function(){this.isOpen()&&("undefined"==typeof this.settings.elements[this.currentIndex+1]&&(this.currentIndex=-1),this.currentIndex++,this._updatePhoto(this.settings.elements[this.currentIndex]))}},Page.prototype={init:function(){},clearHash:function(){history.replaceState({},this._pageTitle,"/")},getHash:function(){return window.location.hash.substring(3)},setHash:function(t){history.pushState({},document.title,"#!/"+t)},resetTitle:function(){document.title=this._pageTitle},setTitle:function(t){this._pageTitle||(this._pageTitle=document.title),document.title=t}},Grid.prototype={init:function(){this.elements={grid:document.querySelector("div.grid")},this._setupElements()},_setupElements:function(){var t=this;Array.prototype.forEach.call(this.gridElement().querySelectorAll("img"),function(e){var i=document.createElement("div");i.classList.add("photo"),i.classList.add(e.classList.toString()),i.dataset.hash=e.dataset.hash,i.dataset.aspectRatio=e.dataset.aspectRatio,i.dataset.large=e.dataset.large,i.setAttribute("title",e.getAttribute("alt")),i.dataset.small=e.getAttribute("src"),i.style.backgroundImage="url("+i.dataset.small+")",t.gridElement().replaceChild(i,e)})},_photoSize:function(t){return Math.floor((this.gridWidth-(t+1)*this.gridSpacing)/t)},gridElement:function(){return this.elements.grid},resize:function(){var t=this;this.gridWidth=parseInt(window.getComputedStyle(this.elements.grid).width),this.gridSpacing=Math.floor(this.gridWidth/100*2.5),this.elements.grid.style.paddingTop=this.gridSpacing+"px",this.elements.grid.style.paddingLeft=this.gridSpacing+"px",Array.prototype.forEach.call(this.elements.grid.querySelectorAll("div.photo"),function(e){e.style.marginRight=t.gridSpacing+"px",e.style.marginBottom=t.gridSpacing+"px"});var e=4;this.gridWidth<800?e=2:this.gridWidth<1100&&(e=3);var i=1,o=0;Array.prototype.forEach.call(this.elements.grid.querySelectorAll("div.photo"),function(n){var s=!1;i>e&&(i=1,o>0&&(i=2)),o>0&&o--,n.classList.contains("wide")?e>i&&(n.style.height=t._photoSize(e)+"px",n.style.width=2*t._photoSize(e)+t.gridSpacing+"px",i+=2,o>0&&o--,s=!0):n.classList.contains("tall")&&1===i&&(n.style.height=2*t._photoSize(e)+t.gridSpacing+"px",n.style.width=t._photoSize(e)+"px",i++,o=2*(e-1),s=!0),s||(n.style.height=t._photoSize(e)+"px",n.style.width=t._photoSize(e)+"px",i++)})}},document.addEventListener("DOMContentLoaded",function(){window.photos={swipe:new Swipe,analytics:new Analytics,page:new Page,grid:new Grid,lightbox:new Lightbox},window.photos.grid.init(),window.photos.grid.resize(),window.addEventListener("resize",function(t){window.photos.grid.resize(),window.photos.lightbox.repositionPhoto()}),window.photos.grid.resize(),window.photos.lightbox.init(20),""!==window.photos.page.getHash()&&(window.photos.lightbox.open(window.photos.page.getHash()),window.photos.analytics.event("Lightbox: open","Direct link")),document.onkeydown=function(t){switch(t.keyCode){case 27:window.photos.lightbox.close(),window.photos.analytics.event("Lightbox: close","Escape key");break;case 37:window.photos.lightbox.previous(),window.photos.analytics.event("Lightbox: previous photo","Left key");break;case 39:window.photos.lightbox.next(),window.photos.analytics.event("Lightbox: next photo","Right key")}},window.addEventListener("hashchange",function(t){return""===window.photos.page.getHash()&&window.photos.lightbox.isOpen()?(window.photos.lightbox.close(),void window.photos.analytics.event("Lightbox: close","Hash change")):(window.photos.lightbox.open(window.photos.page.getHash()),void window.photos.analytics.event("Lightbox: change photo","Hash change"))}),window.photos.analytics.externalLinks()});